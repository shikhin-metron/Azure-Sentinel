Parser:
  Title: Empty Network Session Events Table
  Version: '0.2.0'
  LastUpdated: Sep 12, 2021
Product:
  Name: Microsoft
Normalization:
  Schema: NetworkSession
  Version: '0.2.0'
References:
- Title: ASIM NetworkSession Schema
  Link: https://aka.ms/AzSentinelNetworkSessionDoc
- Title: ASIM
  Link: https://aka.ms/AzSentinelNormalization
Description: |
  The purpose of this function is to generate and guarantee the schema columns
ParserName: vimNetworkSessionEmpty
ParserQuery: | 
 let vimNetworkSessionEmptyEvents=datatable(
    TimeGenerated:datetime
  , _ResourceId:string
  , Type:string
  // -- Event Fields
  , EventMessage:string // Optional
  , EventCount:int // Mandatory
  , EventStartTime:datetime // Mandatory
  , EventEndTime:datetime // Alias
  , EventType:string // Mandatory
  , EventSubType:string // Optional
  , EventResult:string // Mandatory
  , EventResultDetails:string // Optional
  , EventOriginalResultDetails:string // Optional
  , EventSeverity:string // Mandatory
  , EventOriginalSeverity:string // Optional
  , EventOriginalUid:string // Optional
  , EventOriginalType:string // Optional
  , EventProduct:string // Mandatory
  , EventProductVersion:string // Optional
  , EventVendor:string // Mandatory
  , EventSchema:string // Mandatory
  , EventSchemaVersion:string // Mandatory
  , EventReportUrl:string // Mandatory
  , Dvc:string // Alias
  , DvcIpAddr:string // Mandatory
  , DvcHostname:string // Mandatory
  , DvcDomain:string // Recommended
  , DvcDomainType:string // Recommended
  , DvcFQDN:string // Optional
  , DvcId:string // Optional
  , DvcIdType:string // Optional
  // -- Network Session Fields
  , DstIpAddr:string // Recommended
  , DstPortNumber:int // Optional
  , DstHostname:string // Recommended
  , Hostname:string // Alias
  , DstDomain:string // Recommended
  , DstDomainType:string // Recommended
  , DstFQDN:string // Optional
  , DstDvcId:string // Optional
  , DstDvcIdType:string // Optional
  , DstDeviceType:string // Optional
  , DstUserId:string // Optional
  , DstUserIdType:string // Optional
  , DstUsername:string // Optional
  , User:string // Alias
  , DstUsernameType:string // Alias
  , DstUserType:string // Optional
  , DstOriginalUserType:string // Optional
  , DstUserDomain:string // Optional
  , DstAppName:string // Optional
  , DstAppId:string // Optional
  , DstAppType:string // Optional
  , DstZone:string // Optional
  , DstInterfaceName:string // Optional
  , DstInterfaceGuid:string // Optional
  , DstMacAddr:string // Optional
  , DstGeoCountry:string // Optional
  , DstGeoCity:string // Optional
  , DstGeoLatitude:string // Optional
  , DstGeoLongitude:string // Optional
  , SrcIpAddr:string // Recommended
  , SrcPortNumber:int // Optional
  , SrcHostname:string // Recommended
  , SrcDomain:string // Recommended
  , SrcDomainType:string // Recommended
  , SrcFQDN:string // Optional
  , SrcDvcId:string // Optional
  , SrcDvcIdType:string // Optional
  , SrcDeviceType:string // Optional
  , SrcUserId:string // Optional
  , SrcUserIdType:string // Optional
  , SrcUsername:string // Optional
  , SrcUsernameType:string // Alias
  , SrcUserType:string // Optional
  , SrcOriginalUserType:string // Optional
  , SrcUserDomain:string // Optional
  , SrcAppName:string // Optional
  , SrcAppId:string // Optional
  , IpAddr:string // Alias
  , SrcAppType:string // Optional
  , SrcZone:string // Optional
  , SrcInterfaceName:string // Optional
  , SrcInterfaceGuid:string // Optional
  , SrcMacAddr:string // Optional
  , SrcGeoCountry:string // Optional
  , SrcGeoCity:string // Optional
  , SrcGeoLatitude:string // Optional
  , SrcGeoLongitude:string // Optional
  , NetworkApplicationProtocol:string // Optional
  , NetworkProtocol:string // Optional
  , NetworkDirection:string // Optional
  , NetworkDuration:int // Optional
  , Duration:int // Alias
  , NetworkIcmpCode:int // Optional
  , NetworkIcmpType:string // Optional
  , DstBytes:int // Optional
  , SrcBytes:int // Optional
  , NetworkBytes:int // Optional
  , DstPackets:int // Optional
  , SrcPackets:int // Optional
  , NetworkPackets:int // Optional
  , NetworkSessionId:string // Optional
  , SessionId:string // Alias
  // -- Intermediary device fields
  , DstNatIpAddr:string // Optional
  , DstNatPortNumber:int // Optional
  , SrcNatIpAddr:string // Optional
  , SrcNatPortNumber:int // Optional
  , DvcInboundInterface:string // Optional
  , DvcOutboundInterface:string // Optional
  // -- HTTP session fields
  , Url:string // Optional
  , UrlCategory:string // Optional
  , UrlOriginal:string // Optional
  , HttpVersion:string // Optional
  , HttpRequestMethod:string // Optional
  , HttpStatusCode:string // Alias
  , HttpContentType:string // Optional
  , HttpContentFormat:string // Optional
  , HttpReferrer:string // Optional
  , HttpUserAgent:string // Optional
  , UserAgent:string // Alias
  , HttpRequestXff:string // Optional
  , HttpRequestTime:int // Optional
  , HttpResponseTime:int // Optional
  , FileName:string // Optional
  , FileMD5:string // Optional
  , FileSHA1:string // Optional
  , FileSHA256:string // Optional
  , FileSHA512:string // Optional
  , FileSize:string // Optional
  , FileContentType:string // Optional
  // -- Inspection fields
  , NetworkRuleName:string // Optional
  , NetworkRuleNumber:int // Optional
  , Rule:string // Optional
  , DvcAction:string // Optional
  , DvcOriginalAction:string // Optional
  , ThreatId:string // Optional
  , ThreatName:string // Optional
  , ThreatCategory:string // Optional
  , ThreatRiskLevel:int // Optional
  , ThreatRiskLevelOriginal:string // Optional
  )[];
  vimNetworkSessionEmptyEvents